/* ================================================================
   GESTOR D'AVALUACIÓ — style.css
   Base original conservada. Millores quirúrgiques per a mòbil.
================================================================ */

/* ---------------- Body general ---------------- */
body {
  background: #f3f4f6;
  font-family: 'Inter', sans-serif;
  margin: 0;
  padding: 0;
  color: #1f2937;
  /* Evita el rebot de scroll a iOS */
  overscroll-behavior: none;
  /* Elimina el flash blau al tocar en iOS */
  -webkit-tap-highlight-color: transparent;
}

/* ---------------- Contenidor principal ---------------- */
#appRoot, #screen-classes, #screen-class {
  width: 100%;
  max-width: 100%;
  min-height: 100vh;
  margin: 0;
  padding: 1rem;
  border-radius: 0;
  background: linear-gradient(135deg, #f3f4f6 0%, #ffffff 100%);
  color: #1f2937;
  box-shadow: none;
  transition: background 0.3s ease, color 0.3s ease;
}

/* Centrar contingut opcional */
#appRoot > div, #screen-classes > div, #screen-class > div {
  max-width: 1600px;
  margin: 0 auto;
}

/* ---------------- Títols ---------------- */
h1, h2, h3 {
  color: #1f2937;
  font-weight: 700;
}

p, span, td {
  color: #374151;
}

/* ---------------- Targetes de classes ---------------- */
.class-card {
  cursor: pointer;
  padding: 1rem;
  border-radius: 1rem;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  color: white;
  background: linear-gradient(135deg, #6366f1 0%, #a78bfa 100%);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  /* Evita selecció accidental al tocar */
  -webkit-user-select: none;
  user-select: none;
}

.class-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 16px rgba(0,0,0,0.25);
}

/* Feedback tàctil en mòbil */
.class-card:active {
  transform: scale(0.97);
}

.class-card h3 { font-size: 1.25rem; font-weight: 700; margin: 0; }
.class-card p { font-size: 0.875rem; margin: 0.4rem 0 0; }
.class-card .click-hint { font-size: 0.75rem; margin-top: 0.8rem; opacity: 0.9; }

/* ---------------- Header sticky ---------------- */
/* El header es queda visible mentre es fa scroll */
header {
  position: sticky;
  top: 0;
  z-index: 100;
  background: white !important;
  border-bottom: 1px solid #e5e7eb;
  box-shadow: 0 1px 4px rgba(0,0,0,0.06) !important;
}

/* ---------------- Pantalla classe oberta ---------------- */
#btnBack, #btnBack svg {
  color: #1f2937 !important;
  fill: #1f2937 !important;
  background: none !important;
  border: none !important;
  font-weight: 600;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  transition: color 0.2s ease;
  /* Touch target adequat */
  min-height: 44px;
  padding: 0 0.5rem 0 0;
}

#btnBack:hover { color: #6366f1 !important; }

#classSub { display: none !important; }
#classTitle { color: #1f2937 !important; font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem; }

/* ---------------- Notes Table ---------------- */
#notesTable-wrapper {
  flex-grow: 1;
  overflow-x: auto;
  width: auto;
  /* Scroll suau a iOS */
  -webkit-overflow-scrolling: touch;
}

#notesTable {
  width: 100%;
  min-width: 600px;
  border-collapse: collapse;
}

#notesTable th, #notesTable td {
  border: 1px solid #d1d5db;
  padding: 0.5rem;
}

/* Primera columna (noms) fixa en scroll horitzontal */
#notesTable th:first-child,
#notesTable td:first-child {
  position: sticky;
  left: 0;
  background: #f9fafb;
  z-index: 2;
}

#notesTable th:first-child {
  background: #eef2ff;
  z-index: 3;
}

/* Capçaleres fixes en scroll vertical */
#notesTable th {
  position: sticky;
  top: 0;
  z-index: 2;
  background: #eef2ff;
}

.table-input {
  background-color: #f9fafb;
  border: 1px solid #d1d5db;
  color: #111827;
  border-radius: 0.375rem;
  text-align: center;
}

.bg-red-100 { background-color: #fca5a5 !important; }
.bg-yellow-100 { background-color: #fde68a !important; }
.bg-green-100 { background-color: #86efac !important; }

/* ---------------- Botons ---------------- */
button {
  font-weight: 600;
  border-radius: 0.5rem;
  transition: transform 0.2s ease, background 0.2s ease;
  /* Touch target mínim recomanat per Apple/Google */
  min-height: 44px;
}

button:hover { transform: scale(1.03); }
button:active { transform: scale(0.97); }

.bg-indigo-500 {
  background: linear-gradient(90deg, #6366f1, #a78bfa);
  color: white;
}

/* ---------------- Modals ---------------- */
.modal-backdrop { background: rgba(0,0,0,0.35); }
.modal-close, #modalCreateClassBtn, #modalAddStudentBtn, #modalAddActivityBtn {
  border-radius: 0.5rem;
  font-weight: 600;
}

/* ---------------- Modal Calcul ---------------- */
#modalCalc {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.2);
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

#modalCalc .modal-close {
  background: none;
  border: none;
  font-size: 1.2rem;
  cursor: pointer;
}

#formulaButtons button {
  cursor: pointer;
  transition: 0.2s;
}

#formulaButtons button:hover {
  transform: scale(1.05);
}

/* ---------------- Menús ---------------- */
.menu {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
  z-index: 9999 !important;
}

.menu.hidden {
  display: none !important;
}

/* Mínim marge entre botons i targetes de classes */
#btnCreateClass,
#btnDeleteMode,
#btnClassroomImport {
  margin-bottom: 1.5rem;
}

#userArea { 
  position: relative; 
  display: inline-flex; 
  align-items: center; 
  gap: 0.5rem; 
}

#userMenu { 
  top: 100%; 
  right: 0; 
  z-index: 1000; 
  min-width: 150px; 
}

#userMenu button { 
  border: none; 
  background: none; 
  cursor: pointer; 
}

#userMenu button:hover { 
  background-color: #f3f4f6; 
}

/* ---------------- Layout classe oberta ---------------- */
#classScreenWrapper {
  display: flex;
  gap: 0.5rem;
}

/* Contenidor llista d'alumnes (sidebar) */
#studentsListContainer {
  width: 250px;
  max-width: 250px;
  min-width: 200px;
  overflow-y: auto;
  padding: 0.5rem;
  background: #f9fafb;
  border-radius: 0.5rem;
  box-shadow: 0 1px 4px rgba(0,0,0,0.1);
}

/* Blocked cell input */
input.blocked-cell {
  position: relative;
  cursor: not-allowed;
  opacity: 0.95;
  box-shadow: inset 0 0 0 1px rgba(0,0,0,0.05);
  background-image: linear-gradient(
    rgba(255,255,255,0.35),
    rgba(255,255,255,0.35)
  );
  background-blend-mode: lighten;
}

/* Taula d'usuaris administració */
table {
  width: 100%;
  border-collapse: collapse;
  background: white;
  border-radius: 0.75rem;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

th, td {
  border: 1px solid #d1d5db;
  padding: 0.5rem;
  text-align: left;
}

/* Botó tancar llista alumnes només visible en mòbil */
#closeStudentsMobile {
  display: none;
}

#gradesModeToggle:hover {
  transform: scale(1.03);
}

/* ================================================================
   MÒBIL — millores sense canviar mides ni treure funcionalitat
================================================================ */
@media (max-width: 768px) {

  /* ── Capçalera de classe: apila back+títol i botons en dues files ── */
  #screen-class > div.flex.flex-col {
    gap: 0.5rem;
  }

  /* Títol més compacte en mòbil */
  #classTitle {
    font-size: 1.1rem !important;
    margin-bottom: 0 !important;
  }

  /* ── Fila de botons d'acció: scroll horitzontal ── */
  /* Evita que els botons es debordin o es tallin */
  #screen-class .flex.flex-wrap.gap-2 {
    flex-wrap: nowrap;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    padding-bottom: 0.25rem;
    /* Petit indicador visual que hi ha més contingut */
    -webkit-mask-image: linear-gradient(to right, black 85%, transparent 100%);
    mask-image: linear-gradient(to right, black 85%, transparent 100%);
  }

  #screen-class .flex.flex-wrap.gap-2::-webkit-scrollbar {
    display: none;
  }

  /* Tots els fills no es comprimeixen */
  #screen-class .flex.flex-wrap.gap-2 > * {
    flex-shrink: 0;
  }

  /* ── Sidebar alumnes ── */
  #studentsListContainer {
    display: none;
  }

  #studentsListContainer.mobile-open {
    display: flex;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.45);
    justify-content: center;
    align-items: center;
    z-index: 9999;
  }

  #studentsListContent {
    background: white;
    width: 90%;
    max-width: 350px;
    padding: 1rem;
    border-radius: 0.75rem;
    max-height: 90%;
    overflow-y: auto;
    box-shadow: 0 8px 24px rgba(0,0,0,0.25);
  }

  #studentsListContainer {
    width: 0;
    max-width: none;
  }

  /* La graella ocupa tota la pantalla */
  #notesTable-wrapper {
    width: 100% !important;
  }

  /* Botó tancar visible */
  #closeStudentsMobile {
    display: block;
  }

  /* Ocultar títol "Les meves classes" */
  #screen-classes h2 {
    display: none !important;
  }

  /* ── Botons crear/eliminar: amplada completa, un sota l'altre ── */
  #btnCreateClass,
  #btnDeleteMode {
    width: 100%;
    margin-bottom: 0.5rem !important;
    text-align: center;
    justify-content: center;
    display: flex;
    align-items: center;
  }

  /* ── Taula de notes: lletra lleugerament més petita ── */
  .table-input { width: 2rem; font-size: 0.75rem; }
  #notesTable th, #notesTable td { font-size: 0.75rem; padding: 0.3rem; }

  /* ── Login ── */
  #loginScreen { padding: 1rem; }
}

/* ── Responsiu general (tablets) ── */
@media (max-width: 1024px) {
  #appRoot, #screen-classes, #screen-class {
    padding: 0.5rem;
  }
}

/* ── Pantalles molt petites (iPhone SE, etc.) ── */
@media (max-width: 380px) {
  .class-card { padding: 0.5rem; font-size: 0.75rem; }
  .class-card h3 { font-size: 1rem; }
}
